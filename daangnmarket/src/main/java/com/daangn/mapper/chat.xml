<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="mapper.chat">
 <!-- 채팅 생성 전 확인 -->
 <select id="send_chat_check" parameterType="com.spring.vo.ChatVO" resultType="int">
 	select count(cid) from daangn_chat where pid=#{pid} and receiver=#{receiver} and sender=#{sender}
 </select>
 
 <!-- 채팅 생성 -->
 <insert id="send_chat" parameterType="com.spring.vo.ChatVO">
 	insert into daangn_chat values(seq_daangn_lid.nextval, seq_daangn_cid.nextval, #{sender}, #{receiver}, #{pid}, null, sysdate)
 </insert>
 
 <!-- 채팅방 채팅내역, 날짜 -->
 <select id="load_chatlist" parameterType="java.lang.String" resultType="com.spring.vo.ChatVO">
 	select * from daangn_chat where (receiver=#{myid} or sender=#{myid}) and lid=(select max(lid) from daangn_chat where receiver=#{myid} or sender=#{myid} group by cid)
 </select>
 

 
 </mapper>